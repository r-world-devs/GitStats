---
title: "Get repositories"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Get repositories data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7,
  fig.height = 4
)
```

Set connections to hosts.

> Example workflow makes use of public GitLab, but is rather more plausible, that you will use your internal git platforms, where you need to define `host` parameter.

```{r}
library(GitStats)

git_stats <- create_gitstats() %>%
  set_github_host(
    orgs = c("r-world-devs", "openpharma"),
    token = Sys.getenv("GITHUB_PAT")
  ) %>%
  set_gitlab_host(
    orgs = c("mbtests"),
    token = Sys.getenv("GITLAB_PAT_PUBLIC")
  )
```

By default your search preferences are set to `organizations` (`org`), which means that `GitStats` will pull all repositories from the organizations you specified in `set_*_host()`.

```{r}
repos <- get_repos(git_stats)
repos
```

## Set

You can setup your search preferences, either to `org`, `team` or `phrase`. 

With settings you can also set your language and silence the output.

```{r}
set_params(
  gitstats_obj = git_stats,
  verbose = FALSE
)
```

### Team

If you wish to setup your search parameter to `team`, add your team members first:

```{r}
git_stats %>%
  set_team_member("Kamil Wais", "kalimu") %>%
  set_team_member("Krystian Igras", "krystian8207") %>%
  set_team_member("Karolina Marcinkowska", "marcinkowskak") %>%
  set_team_member("Kamil Koziej", "Cotau") %>%
  set_team_member("Maciej BanaÅ›", "maciekbanas")
```

> If you have another logins on other git platform, you should pass them separately, e.g. `set_team_member("Maciej Banas", "maciekbanas", "banasm")`.

Then set the parameters accordingly.

```{r}
set_params(
  gitstats_obj = git_stats,
  search_param = "team",
  team_name = "RWD",
  verbose = FALSE
) 
```

Pull repositories.

```{r}
get_repos(git_stats)
```

### Phrase

With `GitStats` you can look for the repos with a certain phrase in code blobs (you can not do it for the commits!).

```{r}
repos_stats <- create_gitstats() %>%
  set_github_host(
    orgs = c("r-world-devs", "openpharma")
  ) %>% 
  set_params(
    search_param = "phrase",
    phrase = "Shiny",
    verbose = FALSE
  ) %>% 
  get_repos()

head(repos_stats)
```

### Language

You can define a programming language in your settings.

```{r}
repos_stats <- set_params(
  gitstats_obj = git_stats,
  search_param = "org",
  language = "JavaScript",
  verbose = FALSE
) %>% 
  get_repos() 
head(repos_stats)
```

You can always get back to All languages.

```{r}
reset_language(git_stats)
```

## Reset your settings

If you wish to get back to default settings, run:

```{r}
reset(git_stats)
```
